wc_properties <- read.csv("wc_properties.csv")
rm(list = ls())
setwd("/Volumes/Personal/GitHub/CSEC-491/data")
library(haven)
library(foreign)
library(dplyr)
library(purrr)
library(readxl)
library(matrixStats)
library(kableExtra)
library(ggplot2)
wc_properties <- read.csv("wc_properties.csv")
# using price, 30 exempt
sum(sapply(tax_rate_1_tert, function(rate) {
sapply(tertiles, function(q) {
sum(ifelse(wc_properties$unit_price_tertile == q & wc_properties$floor_area > 30,
wc_properties$unit_price * (wc_properties$floor_area - 30) * rate, 0))
})
}))
tax_rate_1_quar <- c(0, 0.005, 0.01, 0.015)
tax_rate_2_quar <- c(0, 0.002, 0.004, 0.005)
tax_rate_1_tert <- c(0, 0.005, 0.01)
tax_rate_2_tert <- c(0, 0.003, 0.005)
tax_rate_1_quin <- c(0, 0.004, 0.008, 0.012, 0.016)
tax_rate_2_quin <- c(0, 0.001, 0.002, 0.004, 0.005)
tertiles <- c(1, 2, 3)
quartiles <- c(1, 2, 3, 4)
quintiles <- c(1, 2, 3, 4, 5)
# using price, 30 exempt
sum(sapply(tax_rate_1_tert, function(rate) {
sapply(tertiles, function(q) {
sum(ifelse(wc_properties$unit_price_tertile == q & wc_properties$floor_area > 30,
wc_properties$unit_price * (wc_properties$floor_area - 30) * rate, 0))
})
}))
sum(sapply(tax_rate_2_tert, function(rate) {
sapply(tertiles, function(q) {
sum(ifelse(wc_properties$unit_price_tertile == q & wc_properties$floor_area > 30,
wc_properties$unit_price * (wc_properties$floor_area - 30) * rate, 0))
})
}))
sum(sapply(tax_rate_1_quar, function(rate) {
sapply(quartiles, function(q) {
sum(ifelse(wc_properties$unit_price_quartile == q & wc_properties$floor_area > 30,
wc_properties$unit_price * (wc_properties$floor_area - 30) * rate, 0))
})
}))
sum(sapply(tax_rate_2_quar, function(rate) {
sapply(quartiles, function(q) {
sum(ifelse(wc_properties$unit_price_quartile == q & wc_properties$floor_area > 30,
wc_properties$unit_price * (wc_properties$floor_area - 30) * rate, 0))
})
}))
sum(sapply(tax_rate_1_quin, function(rate) {
sapply(quintiles, function(q) {
sum(ifelse(wc_properties$unit_price_quintile == q & wc_properties$floor_area > 30,
wc_properties$unit_price * (wc_properties$floor_area - 30) * rate, 0))
})
}))
